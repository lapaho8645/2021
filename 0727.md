## MySql C API 작성

#### 데이터 베이스 접속
```c
   conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, "127.0.0.1", "사용자", "비밀번호", NULL, 0, NULL, 0)){
        printf("cannot connect");
        exit(1);
    }
    else{
        if(mysql_select_db(conn, "데이터베이스 이름")){
            printf("cannot use databases");
            exit(1);
        }
    }
```

#### void query(MYSQL *conn, const char *query_buffer)
mysql구조체와 query_buffer을 받아 쿼리를 수행하고 결과를 출력해주는 함수


```c 
  int i;
        MYSQL_ROW row;
        MYSQL_FIELD * field;
        if(mysql_query(conn, query_buffer)){        //쿼리 수행
            printf("query failed : %s\n", query_buffer);
            printf("errMsg : %s\n", mysql_error(conn));

        }
        result = mysql_use_result(conn);      //수행 결과를 한 개의 ROW씩 받아온다.
        while((row = mysql_fetch_row(result)) != NULL){     //데이터를 0으로 시작하는 숫자형 인텍스 배열로 반환
            for(i = 0; i < mysql_num_fields(result);i++){          //결과값의 필드 개수를 반환
                if(i == 0){
                    while(field = mysql_fetch_field(result))      //필드에 대한 정보를 출력
                        printf("%-25s|", field->name);
                    printf("\n");
                }
                printf("%-25s|", row[i]? row[i] : "NULL");      //데이터 출력
            }
            printf("\n");
        }

        mysql_free_result(result);      //메모리 해제
}
```

#### 1. 테이블 조회
* 코드
```c
  sprintf(query_buffer, "%s", "show tables");
  query(conn, query_buffer);
```
* 결과


#### 2. 테이블 구조 확인
* 코드
```c
  printf("table name: ");
  scanf("%[^\n]s",&table_name);
  getchar();
  sprintf(query_buffer, "desc %s",  table_name);
  query(conn, query_buffer);

```
* 결과

#### 3. 데이터 조회
* 코드
```c
   printf("table name: ");
   scanf("%[^\n]s",&table_name);
   getchar();
   printf("columns name('*' means all data): ");
   scanf("%[^\n]s", &column_name);
   getchar();
   sprintf(query_buffer, "select %s from %s", column_name, table_name);
   query(conn, query_buffer);

```
* 결과

#### 4. 데이터 추가
* 코드
```c
   printf("table name: ");
   scanf("%[^\n]s",&table_name);
   getchar();
   printf("columns name: ");
   scanf("%[^\n]s", &column_name);
   getchar();
   printf("data values : ");
   scanf("%[^\n]s", &data);
   getchar();
   sprintf(query_buffer, "insert into %s (%s) values (%s) ", table_name, column_name, data);
   query(conn, query_buffer);

```
* 결과

#### 5. 데이터 변경
* 코드
```c
  printf("table name: ");
  scanf("%[^\n]s",&table_name);
  getchar();
  printf("Number of columns to update : ");
  scanf("%d", &column_num);
  getchar();
  for(i = 0; i < column_num;i++){
      printf("columns %d : ", i);
      scanf("%[^\n]s", &column_name);
      getchar();
      printf("data %d: ", i);
      scanf("%[^\n]s", &data);
      getchar();
      sprintf(setData,"%s %s = %s",setData, column_name, data);
      if(i != column_num -1)
      sprintf(setData,"%s, ",setData);
  }
  printf("input column name for update : ");
  scanf("%[^\n]s", &column_name);
  getchar();
  printf("input data : ");
  scanf("%[^\n]s", &data);
  getchar();
  sprintf (query_buffer, "update %s set %s where %s=%s", table_name, setData, column_name,data);
  query(conn, query_buffer);
  sprintf(setData, "%s", "");

```
* 결과

#### 6. 데이터 삭제
* 코드
```c
   printf("table name: ");
   scanf("%[^\n]s",&table_name);
   getchar();
   printf("column name : ");
   scanf("%[^\n]s", &column_name);
   getchar();
   printf("data : ");
   scanf("%[^\n]s", &data);
   getchar();
   sprintf(query_buffer, "delete from %s where %s=%s", table_name, column_name, data);
   query(conn, query_buffer );

```
* 결과




